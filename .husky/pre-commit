#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Pre-commit hook for security checks
echo "ğŸ” Running pre-commit security checks..."

# 1. Check for secrets
echo "ğŸ“ Checking for secrets..."
if command -v gitleaks >/dev/null 2>&1; then
  gitleaks protect --staged --verbose || exit 1
else
  echo "âš ï¸  gitleaks not installed"
fi

# 2. Check for .env files
echo "ğŸ“¦ Checking for .env files..."
if git diff --cached --name-only | grep -E "\.env$|\.env\.local$" 2>/dev/null; then
  echo "âŒ .env file detected in commit!"
  exit 1
fi

# 3. Run linter
echo "ğŸ”§ Running linter..."
npm run lint || exit 1

echo "âœ… Pre-commit checks passed!"
